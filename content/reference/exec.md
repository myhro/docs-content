+++
title = "Execute a command in a component instance"
description = "This is the reference page for the 'swarm exec' command, which allows you to call a command inside an instance of a component or open a shell."
date = "2015-05-08"
type = "page"
categories = ["Reference", "Swarm CLI Commands"]
tags = ["swarm exec"]
weight = 40
+++

# Executing a Command in a Component Instance

With the `swarm exec` command, you can start the execution of a new process inside a running instance, which includes running scripts or interactive shells. Any command you run must be supported by the underlying container image for the instance.

## Synopsis

```$ swarm exec <instance-id> [-d|--detach] [--] [<command>]```

* The `instance_id` argument specifies an instance of a running application component.

* When using the `-d` or `--detach` flags, the CLI will detach from the running process. The use of the detach flag is optional.

* The `command` argument specifies the command to be executed on the target instance. If no command argument is given, the command `/bin/sh` is used to open a shell on the instance's container.

* The option separator `--` should be used when a `command` argument contains whitespace.

**Note: Use the [`swarm status`](../status/) command to list all instances of an application. You may use partial IDs, omitting characters from the end, as long as the partial ID is unique within your environment.**

## Examples

Here are a few examples you can try out on your instances.  Let's start by getting the process IDs with ```swarm ls``` + ```swarm status```:

```
$ swarm ls
2 applications available in environment 'bant/dev':

application     created              status
helloworld      2015-05-07 03:28:18  up

$ swarm status
App helloworld is up

service             component             image     instanceid    created              status
helloworld-service  helloworld-component  python:3  f00barjwxe37  2015-05-08 21:42:24  up
```

### Shell Into the Instance

If the instance is running an image which has support for running a bash shell, you should be able to do the following:

```
$ swarm exec f00bar /bin/bash
```

Here's a simple example of shelling into the Giant Swarm [*helloworld*](https://github.com/giantswarm/helloworld) example and getting a directory listing and process list:

```
$ swarm exec f00bar /bin/bash
root@f00barjwxe37:/# ls
bin   dev  home        lib    media  opt   root  sbin  sys  usr
boot  etc  index.html  lib64  mnt    proc  run	 srv   tmp  var
root@f00barjwxe37:/# ps -ax
  PID TTY      STAT   TIME COMMAND
    1 ?        Ss     0:00 sh -c echo "Hello from Giant Swarm. \o/" > index.html
    7 ?        S      0:00 python -m http.server
   16 ?        S      0:00 /bin/bash
   23 ?        R+     0:00 ps -ax
```

The ```swarm exec``` command uses `/bin/sh` by default. This results in a simple way to quickly check in on an instance:

```
$ swarm exec f00bar
```

Quitting a shell session usually requires the `exit` command or hitting `Ctrl + D`.

### Listing Instance Directories
Listing the contents of the default path in an instance with ID ```f00barjwxe37``` can be done by doing the following:

```
$ swarm exec f00bar ls
```

*Note: The use of `ls` requires the `ls` binary be available on the instance. If it fails, try shelling into the instance to debug!*

### Using Parameters with Commands
Using arguments with a ```command``` requires the use of the option separator `--` to keep the Swarm CLI from parsing the command's arguments for itself.

Running ```grep -r foo * | cut -f 1 -d':'``` on an instance with ID ```f00barjwxe37``` can done by doing the following:

```
$ swarm exec f00bar -- grep -r foo * | cut -f 1 -d':'
```

*Note: STDOUT and STDERR for the command will be outputted to your terminal. To detach a blocking process, use the `-d` or `--detach` flag.*

### Long Running Processes
If you need to execute a long running process, use the afore mention ```-d``` or ```--detach``` flags:

```$ swarm exec f00bar -d /path/to/tedious-task```


## Considerations
Best practices for containers seem to indicate containers should only be running a single process. It is also suggested that this process is kicked off using the `ENTRYPOINT` or `CMD` directives in the container's Dockerfile.

Giant Swarm's service assumes a container should be restarted when the main process in the container dies. Extra processes started outside the Dockerfile directives, such as those run by a ```swarm exec```, are not moninitored by Giant Swarm's system. This includes logs or console output generated by these extra processes.

To ensure a process is always running on Giant Swarm, you should ensure the main process in started from the Dockerfile.

The `swarm exec` function is best suited for short-running processes, which could include jobs like importing data into a database, manually creating a backup of a directory, or interactively debugging a system while it's running.

Remember, use your best judgement when adding extra processes to a container. With microservices, less is always more!

## Limitations

The return values of executed commands and their exit codes are not returned by `swarm exec`. This fact makes it difficult to programatically detect whether or not the command exists on the instance, and whether it successfully ran and exited, or not.

## Further Reading

* [Getting an applications's status](../status/) and listing instance IDs available in an application
* [Getting statistics of an application, service, component or instance](../stats/)
